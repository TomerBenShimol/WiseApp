<div>
  <section>
    <h1>AI-Powered WhatsApp Lessons</h1>
    <p>
      Get personalized AI-generated lessons delivered to your WhatsApp. Choose
      your topic, frequency, and schedule.
    </p>
  </section>
  <form (submit)="onSubmit($event)">
    <mat-form-field appearance="outline" class="form-field-container">
      <mat-label>Phone Number</mat-label>
      <input
        matInput
        [formField]="configurationForm.phoneNumber"
        placeholder="Enter your WhatsApp phone number"
        type="tel"
      />
      @if (
        configurationForm.phoneNumber().touched() &&
        !configurationForm.phoneNumber().valid()
      ) {
        <mat-error>
          @for (
            error of configurationForm.phoneNumber().errors();
            track error
          ) {
            {{ error.message }}
          }
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="form-field-container">
      <mat-label>Learning Topic</mat-label>
      <input
        matInput
        [formField]="configurationForm.topic"
        placeholder="Choose or type a topic"
      />
      @if (
        configurationForm.topic().touched() &&
        !configurationForm.topic().valid()
      ) {
        <mat-error>
          @for (error of configurationForm.topic().errors(); track error) {
            {{ error.message }}
          }
        </mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="form-field-container">
      <mat-label>Number of Messages</mat-label>
      <mat-select [formField]="configurationForm.messageCount">
        @for (count of messageCountOptions; track count) {
          <mat-option [value]="count">
            {{ count }} message{{ count > 1 ? "s" : "" }}
          </mat-option>
        }
      </mat-select>
      @if (
        configurationForm.messageCount().touched() &&
        !configurationForm.messageCount().valid()
      ) {
        <mat-error>
          @for (
            error of configurationForm.messageCount().errors();
            track error
          ) {
            {{ error.message }}
          }
        </mat-error>
      }
    </mat-form-field>

    <fieldset class="form-field-container">
      <legend>Select Days for Delivery</legend>
      <div>
        @for (day of WEEKDAYS; track day) {
          <mat-checkbox [formField]="configurationForm[day]" [id]="day">
            {{ day }}
          </mat-checkbox>
        }
      </div>
      @if (configurationForm().touched() && !atLeastOneDaySelected()) {
        <mat-error> At least one day must be selected. </mat-error>
      }
    </fieldset>

    <mat-form-field appearance="outline" class="form-field-container">
      <mat-label>Delivery Time (24-hour format)</mat-label>
      <input
        matInput
        [formField]="configurationForm.deliveryTime"
        [matTimepicker]="timePicker"
        placeholder="HH:mm"
      />
      <mat-timepicker #timePicker></mat-timepicker>
      @if (
        configurationForm.deliveryTime().touched() &&
        !configurationForm.deliveryTime().valid()
      ) {
        <mat-error>
          @for (
            error of configurationForm.deliveryTime().errors();
            track error
          ) {
            {{ error.message }}
          }
        </mat-error>
      }
    </mat-form-field>

    <button
      mat-raised-button
      type="submit"
      [disabled]="!configurationForm().valid()"
    >
      Start Learning
    </button>
  </form>
</div>
